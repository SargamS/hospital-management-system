{% extends "base.html" %}
{% block content %}
<div class="bg-white rounded-2xl p-6 shadow max-w-2xl mx-auto">
  <h3 class="text-lg font-semibold">Generate Bill</h3>
  <form method="post" class="space-y-3">
    <select name="patient_id" class="w-full p-2 border rounded">
      <option value="">Select Patient (optional)</option>
      {% for p in patients %}
      <option value="{{ p.idno }}">{{ p.name }} â€” {{ p.idno }}</option>
      {% endfor %}
    </select>

    <div id="lines" class="space-y-2">
      <div class="flex gap-2 items-center">
        <input name="desc_1" placeholder="Description" class="flex-1 p-2 border rounded">
        <input name="amt_1" placeholder="Amount" type="number" step="0.01" class="w-32 p-2 border rounded">
      </div>
    </div>

    <input type="hidden" name="line_count" id="line_count" value="1">

    <div class="flex gap-2">
      <button type="button" onclick="addLine()" class="px-3 py-1 bg-slate-100 rounded">Add line</button>
      <button class="px-4 py-2 bg-green-600 text-white rounded">Generate Bill</button>
    </div>
  </form>
</div>

<script>
let count = 1;
function addLine(){
  count += 1;
  const container = document.getElementById('lines');
  const div = document.createElement('div');
  div.className = 'flex gap-2 items-center';
  div.innerHTML = `<input name="desc_${count}" placeholder="Description" class="flex-1 p-2 border rounded">
                   <input name="amt_${count}" placeholder="Amount" type="number" step="0.01" class="w-32 p-2 border rounded">`;
  container.appendChild(div);
  document.getElementById('line_count').value = count;
}
</script>
{% endblock %}
